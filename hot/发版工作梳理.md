# 发版工作梳理

## 以发布alpha3版本为例

1. 将新增代码的 toast 展示并入 Config.debugger 和 Config.debugprint 体系。

2.  切换配置到 publish.global.json 并编辑相关debug 标签开关。

3. 软件内测试，未实现的功能链接到 404页面，有规划的入口界面链接到版本规划计划页。

4. 编写新版本体验计划

   - 如何制作并加载动画

   - 如何使用9patch信息设置文章背景图

   - 详细介绍通过支持内嵌代码的方式拓展 markdown 文本

     - 支持图片占位视频

     - 支持段落格式 —— 图片背景和插入动画
       - center / left / right / start / end / merge

   - 介绍配置

     - 如何设置调试方式方便调试自己的文章。

     - 如何管理缓存，适当删除过期数据。
     - 如何配置订阅源，从官方更改成自己的订阅源，用于调试和预览自己的教学内容

5. 添加 github 版本 tag

6. 使用 gitHub 发布 release 包

## 额外问题

### 坑爹的lottie动画制作流程

实践从 Sketch -> AE -> 插件导出json的过程相当坑爹。

1. 只能单向从Sketch 通过AEUX插件导入到 AE，而很难在AE里进行增量修改(回批)，若已经在AE中做了工作则要推倒重来。

2. 无法支持遮罩，需要从 Sketch 设计文件开始去掉遮罩
3. 对文字支持不好，即便打开了插件导出文字单独导出的选项在实际显示时会有位置偏差，解决方案是一律在设计时文字转换成形状(路径)
4. AE的 key 帧流程太繁琐

好处是可以制作路径变换的动画。

而实践从Sketch -> rive.app -> 导出.riv的过程相当轻松，当然rive还不支持细致到路径点变换的动画。

### 解决依赖冲突的问题

加载 rive库的时候又遇到了依赖包版本冲突问题，指向flutter_test 这个sdk自带的库，无奈从官网下载更新包覆盖原 sdk 后执行 `flutter clean` 和`flutter pub get` 项目编译报错，显示很多库的导入`Target of URI doesn't exist，也就是类似 dio 这样的库，有很多是不存在的，难道又是依赖问题？查看一下出问题的库有

- provider
- lexpro
- lottie
- url_luncher
- dio
- path_provider

有我自己写的库，这说明没有规律性，应该不是这些库的依赖问题，查找缓存文件和真实文件地址都是对应的，而命令行执行flutter run，项目正常加载到手机上了，最终说明是IDE的库引用出了问题，删除项目下有关IDE的缓存配置目录重新打开项目问题得以解决。